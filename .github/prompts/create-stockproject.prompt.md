---
mode: agent
---
# Stock Project 後端服務規劃

## 專案目標
建立可擴充的股票回測後端服務，採用 FastAPI，專注於提供 RESTful API，負責資料下載、技術指標計算、回測、圖表產生，並支援前後端分離架構。

## 後端技術規範
- 採用 FastAPI 作為 Web 框架。
- 僅負責 API 服務，不處理前端顯示與訊息互動。
- 程式架構需模組化，便於未來擴充新策略或功能。

## API 設計
- POST `/backtest/ma`：回測 MA 策略，回傳 JSON（報酬率、交易紀錄）。
- POST `/backtest/macd`：回測 MACD 策略，回傳 JSON（報酬率、交易紀錄）。
- GET `/plot/ma`：取得 MA 策略圖表，回傳圖片或圖片網址。
- GET `/plot/macd`：取得 MACD 策略圖表，回傳圖片或圖片網址。

## 回傳格式
- 回測結果以 JSON 格式回傳，內容包含：
  - 股票代碼、期間、總報酬率、交易紀錄（可擴充欄位）
- 圖表可回傳 base64 字串或靜態檔案網址

## 前後端分離
- 前端僅負責訊息處理與顯示（如 line bot），所有資料查詢與運算均由後端 API 處理。
- line bot 透過 HTTP 請求呼叫後端 API，取得回測結果或圖表後回傳給用戶。

## 其他
- 程式需考慮未來擴充性（如多策略、多股票、參數自訂等）。
- 可加上 API Key 或簡易驗證機制。